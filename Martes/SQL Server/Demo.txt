http://sqlfiddle.com/#!3/51039/18