http://sqlfiddle.com/#!9/8ab042/1